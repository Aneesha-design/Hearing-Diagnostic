<!DOCTYPE html> 
<html> 
<!-- The following code has been developed by students and/or researchers of the Freshman Research Initiative DIY Diagnostics Stream at The University of Texas at Austin.  This code is shared for demonstration purposes and should not be considered a product -- it is for entertainment purposes only.  Any user of this code does so at their own risk. Members of the DIY Stream, FRI, and The University of Texas system are not liable for anything related to this code.
 
THIS CODE SHOULD NOT BE USED TO DIAGNOSE ANY KIND OF MEDICAL CONDITION.
 
 
Authors in chronological order of contribution:
Tim Riedel
Sofia Williams
 
Further Information:
http://diystream.cns.utexas.edu/

Research Educator:
Timothy Riedel
triedel@utexas.edu
 
Brief Description of Goal of Code:
The Goal of this code is to help individuals self diagnose if they have hearing loss. This code should not be a definitive diagnosis, but could help people seek help should they need it. 
 
Known Issues:
None that I know of
-->

   <head> 
      
	   <title>Hello World</title>  
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <link rel="stylesheet" href="w3.css">
      <link rel="stylesheet" href="w3-colors-flat.css">
   </head> 


<script>
	//this function plays a beep noise
	function playBeep() {
   	var context = new AudioContext()
	var o = context.createOscillator()
	var g = context.createGain()
	var frequency = 830.6
	o.frequency.value = frequency 
	o.connect(g)
	g.connect(context.destination)
	o.start(0)
		g.gain.exponentialRampToValueAtTime(
 		0.00001, context.currentTime + 5)
	}
	
	//these functions add one to variable count based on user answers
	var yes1 = 0
	function yesAdd1(){
		yes1 + 1
	}
	var no1 = 0
	function noAdd1(){
		no1 + 1
	}
	
	
	//imported decibel functions
	function dBFSToGain(dbfs) {  
  	return Math.pow(10, dbfs / 20);
	}
	
	
	function decibel(){
	let audioCtx = new AudioContext()

	// Create nodes
	let osc = audioCtx.createOscillator()
	let gain = audioCtx.createGain()

	// Set parameters
	osc.frequency.value = 125
	gain.gain.value = 0.01
	
	// Schedule parameter changes
	
	// Drop to -12 dBFS at ~1s
	gain.gain.setValueAtTime(1, 1 - 0.03);
	gain.gain.linearRampToValueAtTime(dBFSToGain(-100), 1)


	// Connect graph
	//osc.connect(gain)
	//gain.connect(audioCtx.destination)
		
	//Creating Stereo Panner to Output on L Headphone
	var panNode = audioCtx.createStereoPanner()
	panNode.pan.value = 1
	
	//Connect graph
	osc.connect(gain)
	gain.connect(panNode)
	panNode.connect(audioCtx.destination) 
	
	// Schedule start and stop
	//osc.start()
		osc.start(0)
		panNode.gain.exponentialRampToValueAtTime(
 		0.00001, context.currentTime + 5)
	osc.stop(audioCtx.currentTime + 2)
	}
	
</script>
<style>	
.body {
     margin: 0em;
}

.page {
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: -100vw;
    overflow-y: auto;
    z-index: 0;
    background-color: hsl(0,0%,100%);
}

  .page:target {
    left: 0vw;
    z-index: 1;
}
</style>
	<body>
<div id="header" class="w3-container w3-flat-carrot">
	<h1>Hearing Loss Detection</h1>
</div>
	
<div id="content" class="w3-container">
	<p>Answer a few short questions to find out if you may have hearing loss. </p>
	
	<a href="#one" class="w3-btn w3-grey w3-round"> Get Started </a>
	
	<p>The following code has been developed by students and/or researchers of the Freshman Research Initiative DIY Diagnostics Stream at The University of Texas at 		Austin.  This code is shared for demonstration purposes and should not be considered a product -- it is for entertainment purposes only. Any user of this code 			does so at their own risk. Members of the DIY Stream, FRI, and The University of Texas system are not liable for anything related to this code.</p>
 	
	<p>THIS CODE SHOULD NOT BE USED TO DIAGNOSE ANY KIND OF MEDICAL CONDITION.</p>

<div class="page" id="one">
	<div id="header" class="w3-container w3-flat-carrot">
		<h1>Question 1</h1>
	</div>
	
    	<div id="content" class="w3-container">
        <p>Press the button below to hear the first sound. </p>    
	<a href="#one" onclick="playBeep();" class="w3-btn w3-black"> Play </a><!--button starts beeping noise-->
	<a href="#one" onclick="decibel();" class="w3-btn w3-black"> Decibel Fcn Test </a><!--button starts beeping noise-->
	
	<p> Were you able to hear the sound? </p> 
	<a href="#two" onclick="yesAdd1();" class="w3-btn w3-black"> Yes </a><!--button adds one to yes count-->	
	<a href="#two" onclick="noAdd1();" class="w3-btn w3-black"> No </a><!--button adds one to no count-->
    	</div>
</div>
	<div class="page" id="one">
	<div id="header" class="w3-container w3-flat-carrot">
		<h1>Question 1</h1>
	</div>
	
    	<div id="content" class="w3-container">
        <p>Press the button below to hear the first sound. </p>    
	<a href="#one" onclick="playBeep();" class="w3-btn w3-black"> Play </a><!--button starts beeping noise-->
	<a href="#one" onclick="decibel();" class="w3-btn w3-black"> Decibel Fcn Test </a><!--button starts beeping noise-->
	
	<p> Were you able to hear the sound? </p> 
	<a href="#two" onclick="yesAdd1();" class="w3-btn w3-black"> Yes </a><!--button adds one to yes count-->	
	<a href="#two" onclick="noAdd1();" class="w3-btn w3-black"> No </a><!--button adds one to no count-->
    	</div>
</div>
	<footer class="w3-bottom w3-container w3-flat-carrot">
	<p>DIY DIAGNOSTICS!</p>
</footer>

</body>
</html>
